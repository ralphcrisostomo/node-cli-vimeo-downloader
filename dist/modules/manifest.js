"use strict";var Manifest,chalk,fs,request;request=require("superagent"),chalk=require("chalk"),fs=require("fs"),Manifest=function(){function e(){this.manifest=[]}return e.prototype._downloadManifest=function(e,t,n){var s;return s=50,request.get("https://"+process.env.VIMEO_HOST+"/users/"+e+"/videos?page="+t+"&per_page="+s).set("Content-Type",process.env.VIMEO_CONTENT_TYPE).set("Authorization",process.env.VIMEO_AUTHORIZATION).set("host",""+process.env.VIMEO_HOST).end(function(s){return function(r,o){var i,a,u;return r?r:(i=null!=(u=o.body)?u.data:void 0,null!=i&&i.forEach(function(e){var t,n;return s.manifest.push({id:parseInt(null!=e&&null!=(t=e.uri)&&null!=(n=t.split("/"))?n[2]:void 0),name:null!=e?e.name:void 0,status:"created"})}),process.stdout.write(chalk.cyan("\nDownloading manifest... "+s.manifest.length+" of "+o.body.total+"\r")),s.manifest.length!==o.body.total?s._downloadManifest(e,t+1,n):(process.stdout.write(chalk.green("\nDownload manifest : done")),process.stdout.write(chalk.blue("\nWriting `manifest.json`...")),a=process.cwd()+"/"+e+"/manifest.json",fs.writeFile(a,JSON.stringify(s.manifest,null,4),function(e){return process.stdout.write(chalk.green("\nWriting `manifest.json` : done")),n(e,s.manifest)})))}}(this))},e.prototype.create=function(e){return function(t){return function(n){return process.stdout.write(chalk.blue("\nCreating `manifest.json`...")),t._downloadManifest(e,1,n)}}(this)},e}(),module.exports=Manifest;