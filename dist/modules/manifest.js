"use strict";var Manifest,fs,mixin,request;request=require("superagent"),fs=require("fs"),mixin=require("./mixin"),Manifest=function(){function n(){this.manifest=[]}return n.prototype._downloadManifest=function(n,e,t){var i;return i=50,request.get("https://"+process.env.VIMEO_HOST+"/users/"+n+"/videos?page="+e+"&per_page="+i).set("Content-Type",process.env.VIMEO_CONTENT_TYPE).set("Authorization",process.env.VIMEO_AUTHORIZATION).set("host",""+process.env.VIMEO_HOST).end(function(i){return function(r,s){var o,a,u;return r?r:(o=null!=(u=s.body)?u.data:void 0,null!=o&&o.forEach(function(n){var e,t;return i.manifest.push({id:parseInt(null!=n&&null!=(e=n.uri)&&null!=(t=e.split("/"))?t[2]:void 0),name:null!=n?n.name:void 0,status:"created"})}),mixin.write("cyan","\nDownloading manifest... "+i.manifest.length+" of "+s.body.total+"\r"),i.manifest.length!==s.body.total?i._downloadManifest(n,e+1,t):(mixin.write("green","\nDownloading manifest : done"),mixin.write("blue","\nWriting `manifest.json`..."),a=process.cwd()+"/"+n+"/manifest.json",fs.writeFile(a,JSON.stringify(i.manifest,null,4),function(n){return mixin.write("green","\nWriting `manifest.json` : done"),t(n,i.manifest)})))}}(this))},n.prototype.create=function(n){return function(e){return function(t){return mixin.write("blue","\nCreating `manifest.json`..."),e._downloadManifest(n,1,t)}}(this)},n}(),module.exports=Manifest;