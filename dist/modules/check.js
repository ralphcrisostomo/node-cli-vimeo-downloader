"use strict";var Check,Manifest,_,async,fs,mixin,path;_=require("lodash"),async=require("async"),fs=require("fs"),path=require("path"),Manifest=require("./manifest"),mixin=require("./mixin"),Check=function(){function n(){}return n.prototype.run=function(n){return function(e){return function(r){return async.series([e._checkDirectory(n),e._checkManifest(n),e._checkVideos(n)],r)}}(this)},n.prototype._checkDirectory=function(n){return function(e){var r;return mixin.write("blue","\nChecking directory..."),r=process.cwd()+"/"+n,fs.existsSync(r)?(mixin.write("green","\nChecking directory : done"),e(null,{})):(mixin.write("red","\nDirectory do not exist."),mixin.write("blue","\nCreating directory...."),fs.mkdir(""+r,"0777",function(n){return n&&mixin.write("green","\nError while creating directory!"),mixin.write("green","\nCreating directory : done"),e(null,{})}))}},n.prototype._checkManifest=function(n){return function(e){var r,i;return mixin.write("blue","\nChecking `manifest.json`..."),r=process.cwd()+"/"+n,fs.existsSync(r+"/manifest.json")?(mixin.write("green","\nChecking `manifest.json` : done"),e(null,{})):(mixin.write("red","\nManifest do not exist."),i=new Manifest,i.create(n,1)(e))}},n.prototype._checkVideos=function(n){return function(e){return mixin.write("blue","\nChecking videos..."),async.waterfall([function(e){var r,i;return i=[],r=process.cwd()+"/"+n,fs.readdir(r,function(n,r){return r.forEach(function(n){var e;return e=null!=n?n.match(/(\d+)/g):void 0,i=_.union(i,e)}),e(n,i)})},function(e,r){var i,t;return i=e,t=process.cwd()+"/"+n+"/manifest.json",fs.readFile(t,"utf8",function(n,e){return console.log(e),r(n,e)})}],function(n,r){return mixin.write("green","\nChecking videos : done"),e(n,files)})}},n}(),module.exports=Check;